{"ast":null,"code":"import _objectSpread from\"/Users/saloniangre/Downloads/Fuelroute/FinalFRP/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Link}from'react-router-dom';import'./Subscription.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Subscription=()=>{const[currentUser,setCurrentUser]=useState(null);const[cardNumber,setCardNumber]=useState('');const[expiry,setExpiry]=useState('');const[cvv,setCvv]=useState('');const[message,setMessage]=useState('');useEffect(()=>{const user=JSON.parse(localStorage.getItem('currentUser')||'{}');setCurrentUser(user);},[]);const handleSubscribe=async e=>{e.preventDefault();if(!currentUser||!currentUser.id){setMessage('Please login first.');return;}try{const res=await fetch('http://localhost:5001/api/payments',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({userId:currentUser.id,cardNumber,expiry,cvv})});if(!res.ok){throw new Error('Payment failed');}const data=await res.json();if(data.success){const updatedUser=_objectSpread(_objectSpread({},currentUser),{},{isSubscribed:true});localStorage.setItem('currentUser',JSON.stringify(updatedUser));const users=JSON.parse(localStorage.getItem('fuelrouteUsers')||'[]');const idx=users.findIndex(u=>u.id===currentUser.id);if(idx>-1){users[idx]=updatedUser;localStorage.setItem('fuelrouteUsers',JSON.stringify(users));}setCurrentUser(updatedUser);setMessage('Subscription successful! You now have unlimited searches.');}else{throw new Error(data.error||'Payment failed');}}catch(err){console.error('Subscription error',err);setMessage('Subscription failed. Please try again.');}};return/*#__PURE__*/_jsx(\"div\",{className:\"subscription-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"subscription-card\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"FuelRoute Pro Subscription\"}),/*#__PURE__*/_jsx(\"p\",{className:\"price\",children:\"$15/month\"}),/*#__PURE__*/_jsx(\"p\",{className:\"info\",children:\"First 3 searches are free. Subscribe to continue using the calculator.\"}),message&&/*#__PURE__*/_jsx(\"div\",{className:\"message\",children:message}),currentUser!==null&&currentUser!==void 0&&currentUser.isSubscribed?/*#__PURE__*/_jsx(\"div\",{className:\"already\",children:\"You are already subscribed.\"}):/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubscribe,className:\"subscription-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Card Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:cardNumber,onChange:e=>setCardNumber(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"MM/YY\",value:expiry,onChange:e=>setExpiry(e.target.value),required:true}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"CVV\",value:cvv,onChange:e=>setCvv(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"subscribe-btn\",children:\"Subscribe\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"back-link\",children:/*#__PURE__*/_jsx(Link,{to:\"/how-it-works\",children:\"Back to Hub\"})})]})});};export default Subscription;","map":{"version":3,"names":["React","useState","useEffect","Link","jsx","_jsx","jsxs","_jsxs","Subscription","currentUser","setCurrentUser","cardNumber","setCardNumber","expiry","setExpiry","cvv","setCvv","message","setMessage","user","JSON","parse","localStorage","getItem","handleSubscribe","e","preventDefault","id","res","fetch","method","headers","body","stringify","userId","ok","Error","data","json","success","updatedUser","_objectSpread","isSubscribed","setItem","users","idx","findIndex","u","error","err","console","className","children","onSubmit","type","value","onChange","target","required","placeholder","to"],"sources":["/Users/saloniangre/Downloads/Fuelroute/FinalFRP/frontend/src/components/Subscription.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { Link } from 'react-router-dom';\nimport './Subscription.css';\n\nconst Subscription = () => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [cardNumber, setCardNumber] = useState('');\n  const [expiry, setExpiry] = useState('');\n  const [cvv, setCvv] = useState('');\n  const [message, setMessage] = useState('');\n\n  useEffect(() => {\n    const user = JSON.parse(localStorage.getItem('currentUser') || '{}');\n    setCurrentUser(user);\n  }, []);\n\n  const handleSubscribe = async (e) => {\n    e.preventDefault();\n    if (!currentUser || !currentUser.id) {\n      setMessage('Please login first.');\n      return;\n    }\n\n    try {\n      const res = await fetch('http://localhost:5001/api/payments', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userId: currentUser.id,\n          cardNumber,\n          expiry,\n          cvv\n        })\n      });\n\n      if (!res.ok) {\n        throw new Error('Payment failed');\n      }\n\n      const data = await res.json();\n      if (data.success) {\n        const updatedUser = { ...currentUser, isSubscribed: true };\n        localStorage.setItem('currentUser', JSON.stringify(updatedUser));\n\n        const users = JSON.parse(localStorage.getItem('fuelrouteUsers') || '[]');\n        const idx = users.findIndex((u) => u.id === currentUser.id);\n        if (idx > -1) {\n          users[idx] = updatedUser;\n          localStorage.setItem('fuelrouteUsers', JSON.stringify(users));\n        }\n        setCurrentUser(updatedUser);\n        setMessage('Subscription successful! You now have unlimited searches.');\n      } else {\n        throw new Error(data.error || 'Payment failed');\n      }\n    } catch (err) {\n      console.error('Subscription error', err);\n      setMessage('Subscription failed. Please try again.');\n    }\n  };\n\n  return (\n    <div className=\"subscription-container\">\n      <div className=\"subscription-card\">\n        <h1>FuelRoute Pro Subscription</h1>\n        <p className=\"price\">$15/month</p>\n        <p className=\"info\">First 3 searches are free. Subscribe to continue using the calculator.</p>\n        {message && <div className=\"message\">{message}</div>}\n        {currentUser?.isSubscribed ? (\n          <div className=\"already\">You are already subscribed.</div>\n        ) : (\n          <form onSubmit={handleSubscribe} className=\"subscription-form\">\n            <div className=\"form-group\">\n              <label>Card Number</label>\n              <input\n                type=\"text\"\n                value={cardNumber}\n                onChange={(e) => setCardNumber(e.target.value)}\n                required\n              />\n            </div>\n            <div className=\"form-row\">\n              <input\n                type=\"text\"\n                placeholder=\"MM/YY\"\n                value={expiry}\n                onChange={(e) => setExpiry(e.target.value)}\n                required\n              />\n              <input\n                type=\"text\"\n                placeholder=\"CVV\"\n                value={cvv}\n                onChange={(e) => setCvv(e.target.value)}\n                required\n              />\n            </div>\n            <button type=\"submit\" className=\"subscribe-btn\">Subscribe</button>\n          </form>\n        )}\n        <div className=\"back-link\">\n          <Link to=\"/how-it-works\">Back to Hub</Link>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Subscription;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}